/* Formatted on 17/06/2014 18:10:09 (QP5 v5.227.12220.39754) */
CREATE OR REPLACE FORCE VIEW MCRE_OWN.V_MCRES_APP_DETT_SP_AZIONI
(
   COD_ABI,
   COD_AUTORIZZAZIONE,
   COD_TIPO_AUTORIZZAZIONE,
   VAL_ANNO_PRATICA,
   COD_PRATICA,
   COD_STATO,
   VAL_NUMERO_FATTURA,
   DTA_FATTURA,
   COD_IMPORTO_DIVISA,
   VAL_IMPORTO_VALORE,
   COD_CAUSALE,
   COD_CAUSA_DIVISA,
   VAL_CAUSA_IMPORTO,
   COD_INTESTATARIO_TIPO,
   DESC_INTESTATARIO,
   VAL_INTESTATARIO_CODFISC,
   VAL_INTESTATARIO_PIVA,
   COD_AFAVORE_TIPO,
   DESC_AFAVORE,
   VAL_AFAVORE_CODFISC,
   VAL_AFAVORE_PIVA,
   FLG_CONVENZIONE,
   DESC_SPESA,
   FLG_SPESA_RIPETIBILE,
   VAL_ENTE_PAGATORE,
   COD_TIPO_PAGAMENTO,
   VAL_BON_DESTINATARIO,
   VAL_BON_COORDINATE,
   DTA_BON_VALUTA,
   VAL_CIRC_INTESTATARIO,
   VAL_CIRC_TRASFERIBILE,
   FLG_SPESA_RECUPERATA,
   COD_ORGANO_AUTORIZZANTE,
   VAL_NOTE,
   VAL_SPESA_NON_FATTURATA,
   COD_PUNTO_OPERATIVO,
   COD_PROTOCOLLO,
   DTA_GENERAZIONE_PROTOCOLLO,
   COD_INTESTATARIO_ABI,
   COD_INTESTATARIO_CAB,
   VAL_INTESTATARIO_CONTO,
   FLG_ANN_AUTORIZ,
   DTA_UPD,
   COD_PRATICA_CEDUTA,
   FLG_CARICO_CESSIONARIO,
   COD_UO_PRATICA,
   COD_IBAN,
   VAL_FAX,
   VAL_RIFERIMENTO_NOMINATIVO,
   VAL_RAPPRESENTANTE,
   VAL_NOTE2,
   FLG_FM,
   VAL_IMPORTO_FM,
   COD_NDG,
   VAL_NOTE_FM,
   VAL_NUM_PROFORMA,
   DTA_PROFORMA_A_FATTURA,
   COD_CAUSALE_888,
   COD_MATRICOLA_AGG_STATO_Z,
   DTA_AUTORIZZAZIONE,
   COD_MATRICOLA,
   COD_UO,
   DTA_UPD_SPESA,
   DTA_INS_SPESA,
   COD_AZIONE,
   COD_UO_PRATICA_PR,
   COD_MATR_PRATICA
)
AS
   SELECT sp."COD_ABI",
          sp."COD_AUTORIZZAZIONE",
          sp."COD_TIPO_AUTORIZZAZIONE",
          sp."VAL_ANNO_PRATICA",
          sp."COD_PRATICA",
          sp."COD_STATO",
          sp."VAL_NUMERO_FATTURA",
          sp."DTA_FATTURA",
          sp."COD_IMPORTO_DIVISA",
          sp."VAL_IMPORTO_VALORE",
          sp."COD_CAUSALE",
          sp."COD_CAUSA_DIVISA",
          sp."VAL_CAUSA_IMPORTO",
          sp."COD_INTESTATARIO_TIPO",
          sp."DESC_INTESTATARIO",
          sp."VAL_INTESTATARIO_CODFISC",
          sp."VAL_INTESTATARIO_PIVA",
          sp."COD_AFAVORE_TIPO",
          sp."DESC_AFAVORE",
          sp."VAL_AFAVORE_CODFISC",
          sp."VAL_AFAVORE_PIVA",
          sp."FLG_CONVENZIONE",
          sp."DESC_SPESA",
          sp."FLG_SPESA_RIPETIBILE",
          sp."VAL_ENTE_PAGATORE",
          sp."COD_TIPO_PAGAMENTO",
          sp."VAL_BON_DESTINATARIO",
          sp."VAL_BON_COORDINATE",
          sp."DTA_BON_VALUTA",
          sp."VAL_CIRC_INTESTATARIO",
          sp."VAL_CIRC_TRASFERIBILE",
          sp."FLG_SPESA_RECUPERATA",
          sp."COD_ORGANO_AUTORIZZANTE",
          sp."VAL_NOTE",
          sp."VAL_SPESA_NON_FATTURATA",
          sp."COD_PUNTO_OPERATIVO",
          sp."COD_PROTOCOLLO",
          sp."DTA_GENERAZIONE_PROTOCOLLO",
          sp."COD_INTESTATARIO_ABI",
          sp."COD_INTESTATARIO_CAB",
          sp."VAL_INTESTATARIO_CONTO",
          sp."FLG_ANN_AUTORIZ",
          sp."DTA_UPD",
          sp."COD_PRATICA_CEDUTA",
          sp."FLG_CARICO_CESSIONARIO",
          sp."COD_UO_PRATICA",
          sp."COD_IBAN",
          sp."VAL_FAX",
          sp."VAL_RIFERIMENTO_NOMINATIVO",
          sp."VAL_RAPPRESENTANTE",
          sp."VAL_NOTE2",
          sp."FLG_FM",
          sp."VAL_IMPORTO_FM",
          sp."COD_NDG",
          sp."VAL_NOTE_FM",
          sp."VAL_NUM_PROFORMA",
          sp."DTA_PROFORMA_A_FATTURA",
          sp."COD_CAUSALE_888",
          sp."COD_MATRICOLA_AGG_STATO_Z",
          sp."DTA_AUTORIZZAZIONE",
          sp."COD_MATRICOLA",
          sp."COD_UO",
          sp."DTA_UPD_SPESA",
          sp."DTA_INS_SPESA",
          a.cod_azione,
          pr.cod_uo_pratica cod_uo_pratica_pr,
          pr.cod_matr_pratica
     FROM t_mcres_app_sp_spese sp,
          t_mcres_app_sp_azioni a,
          T_Mcres_App_Pratiche Pr
    WHERE     Sp.Cod_Pratica = Pr.Cod_Pratica
          AND Sp.Cod_Abi = Pr.Cod_Abi
          AND sp.val_anno_pratica = pr.val_anno || ''
          AND sp.cod_autorizzazione = a.cod_autorizzazione;


GRANT DELETE, INSERT, REFERENCES, SELECT, UPDATE, ON COMMIT REFRESH, QUERY REWRITE, DEBUG, FLASHBACK, MERGE VIEW ON MCRE_OWN.V_MCRES_APP_DETT_SP_AZIONI TO MCRE_USR;

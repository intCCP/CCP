/* Formatted on 17/06/2014 18:16:55 (QP5 v5.227.12220.39754) */
CREATE OR REPLACE FORCE VIEW MCRE_OWN.VTMCRE0_APP_RIO_MONITORAGGIO
(
   COD_ABI_CARTOLARIZZATO,
   COD_ABI_ISTITUTO,
   DESC_ISTITUTO,
   COD_NDG,
   COD_SNDG,
   DTA_CONTROLLO_AT,
   VAL_STRATEGIA_CREDITIZIA_AT,
   VAL_PD_ONLINE_AT,
   VAL_PD_MONIT_AT,
   DTA_PD_MONIT_AT,
   VAL_IRIS_CLI_AT,
   VAL_LGD_AT,
   VAL_EAD_AT,
   SCSB_ACC_TOT_AT,
   SCSB_UTI_TOT_AT,
   SCGB_ACC_TOT_AT,
   SCGB_UTI_TOT_AT,
   SCSB_ACC_CASSA_BT_AT,
   SCSB_UTI_CASSA_BT_AT,
   SCGB_ACC_CASSA_BT_AT,
   SCGB_UTI_CASSA_BT_AT,
   SCSB_QIS_ACC_AT,
   SCSB_QIS_UTI_AT,
   SCGB_QIS_ACC_AT,
   SCGB_QIS_UTI_AT,
   SCSB_SCONFINO_AT,
   VAL_PA_AT,
   COD_STATO_1,
   DTA_CONTROLLO_1,
   VAL_STRATEGIA_CREDITIZIA_1,
   VAL_PD_ONLINE_1,
   VAL_PD_MONIT_1,
   DTA_PD_MONIT_1,
   VAL_RATING_1,
   VAL_IRIS_CLI_1,
   VAL_LGD_1,
   VAL_EAD_1,
   SCSB_ACC_TOT_1,
   SCSB_UTI_TOT_1,
   SCGB_ACC_TOT_1,
   SCGB_UTI_TOT_1,
   SCSB_ACC_CASSA_BT_1,
   SCSB_UTI_CASSA_BT_1,
   SCGB_ACC_CASSA_BT_1,
   SCGB_UTI_CASSA_BT_1,
   SCSB_QIS_ACC_1,
   SCSB_QIS_UTI_1,
   SCGB_QIS_ACC_1,
   SCGB_QIS_UTI_1,
   SCSB_SCONFINO_1,
   VAL_PA_1,
   COD_STATO_2,
   DTA_CONTROLLO_2,
   VAL_STRATEGIA_CREDITIZIA_2,
   VAL_PD_ONLINE_2,
   VAL_PD_MONIT_2,
   DTA_PD_MONIT_2,
   VAL_RATING_2,
   VAL_IRIS_CLI_2,
   VAL_LGD_2,
   VAL_EAD_2,
   SCSB_ACC_TOT_2,
   SCSB_UTI_TOT_2,
   SCGB_ACC_TOT_2,
   SCGB_UTI_TOT_2,
   SCSB_ACC_CASSA_BT_2,
   SCSB_UTI_CASSA_BT_2,
   SCGB_ACC_CASSA_BT_2,
   SCGB_UTI_CASSA_BT_2,
   SCSB_QIS_ACC_2,
   SCSB_QIS_UTI_2,
   SCGB_QIS_ACC_2,
   SCGB_QIS_UTI_2,
   SCSB_SCONFINO_2,
   VAL_PA_2,
   COD_STATO_3,
   DTA_CONTROLLO_3,
   VAL_STRATEGIA_CREDITIZIA_3,
   VAL_PD_ONLINE_3,
   VAL_PD_MONIT_3,
   DTA_PD_MONIT_3,
   VAL_RATING_3,
   VAL_IRIS_CLI_3,
   VAL_LGD_3,
   VAL_EAD_3,
   SCSB_ACC_TOT_3,
   SCSB_UTI_TOT_3,
   SCGB_ACC_TOT_3,
   SCGB_UTI_TOT_3,
   SCSB_ACC_CASSA_BT_3,
   SCSB_UTI_CASSA_BT_3,
   SCGB_ACC_CASSA_BT_3,
   SCGB_UTI_CASSA_BT_3,
   SCSB_QIS_ACC_3,
   SCSB_QIS_UTI_3,
   SCGB_QIS_ACC_3,
   SCGB_QIS_UTI_3,
   SCSB_SCONFINO_3,
   VAL_PA_3,
   COD_STATO_4,
   DTA_CONTROLLO_4,
   VAL_STRATEGIA_CREDITIZIA_4,
   VAL_PD_ONLINE_4,
   VAL_PD_MONIT_4,
   DTA_PD_MONIT_4,
   VAL_RATING_4,
   VAL_IRIS_CLI_4,
   VAL_LGD_4,
   VAL_EAD_4,
   SCSB_ACC_TOT_4,
   SCSB_UTI_TOT_4,
   SCGB_ACC_TOT_4,
   SCGB_UTI_TOT_4,
   SCSB_ACC_CASSA_BT_4,
   SCSB_UTI_CASSA_BT_4,
   SCGB_ACC_CASSA_BT_4,
   SCGB_UTI_CASSA_BT_4,
   SCSB_QIS_ACC_4,
   SCSB_QIS_UTI_4,
   SCGB_QIS_ACC_4,
   SCGB_QIS_UTI_4,
   SCSB_SCONFINO_4,
   VAL_PA_4,
   COD_STATO_5,
   DTA_CONTROLLO_5,
   VAL_STRATEGIA_CREDITIZIA_5,
   VAL_PD_ONLINE_5,
   VAL_PD_MONIT_5,
   DTA_PD_MONIT_5,
   VAL_RATING_5,
   VAL_IRIS_CLI_5,
   VAL_LGD_5,
   VAL_EAD_5,
   SCSB_ACC_TOT_5,
   SCSB_UTI_TOT_5,
   SCGB_ACC_TOT_5,
   SCGB_UTI_TOT_5,
   SCSB_ACC_CASSA_BT_5,
   SCSB_UTI_CASSA_BT_5,
   SCGB_ACC_CASSA_BT_5,
   SCGB_UTI_CASSA_BT_5,
   SCSB_QIS_ACC_5,
   SCSB_QIS_UTI_5,
   SCGB_QIS_ACC_5,
   SCGB_QIS_UTI_5,
   SCSB_SCONFINO_5,
   VAL_PA_5,
   COD_STATO_6,
   DTA_CONTROLLO_6,
   VAL_STRATEGIA_CREDITIZIA_6,
   VAL_PD_ONLINE_6,
   VAL_PD_MONIT_6,
   DTA_PD_MONIT_6,
   VAL_RATING_6,
   VAL_IRIS_CLI_6,
   VAL_LGD_6,
   VAL_EAD_6,
   SCSB_ACC_TOT_6,
   SCSB_UTI_TOT_6,
   SCGB_ACC_TOT_6,
   SCGB_UTI_TOT_6,
   SCSB_ACC_CASSA_BT_6,
   SCSB_UTI_CASSA_BT_6,
   SCGB_ACC_CASSA_BT_6,
   SCGB_UTI_CASSA_BT_6,
   SCSB_QIS_ACC_6,
   SCSB_QIS_UTI_6,
   SCGB_QIS_ACC_6,
   SCGB_QIS_UTI_6,
   SCSB_SCONFINO_6,
   VAL_PA_6,
   COD_STATO_AT,
   DTA_CONTROLLO_PC,
   COD_STATO_PC,
   VAL_STRATEGIA_CREDITIZIA_PC,
   VAL_PD_ONLINE_PC,
   VAL_PD_MONIT_PC,
   DTA_PD_MONIT_PC,
   VAL_RATING_PC,
   VAL_IRIS_CLI_PC,
   VAL_LGD_PC,
   VAL_EAD_PC,
   SCSB_ACC_TOT_PC,
   SCSB_UTI_TOT_PC,
   SCGB_ACC_TOT_PC,
   SCGB_UTI_TOT_PC,
   SCSB_ACC_CASSA_BT_PC,
   SCSB_UTI_CASSA_BT_PC,
   SCGB_ACC_CASSA_BT_PC,
   SCGB_UTI_CASSA_BT_PC,
   SCSB_QIS_ACC_PC,
   SCSB_QIS_UTI_PC,
   SCGB_QIS_ACC_PC,
   SCGB_QIS_UTI_PC,
   SCSB_SCONFINO_PC,
   VAL_PA_PC,
   VAL_PA_VS_PC_AT,
   VAL_PA_VS_PC_1,
   VAL_PA_VS_PC_2,
   VAL_PA_VS_PC_3,
   VAL_PA_VS_PC_4,
   VAL_PA_VS_PC_5,
   VAL_DELTA_PA_VS_PC_AT,
   VAL_DELTA_PA_VS_PC_1,
   VAL_DELTA_PA_VS_PC_2,
   VAL_DELTA_PA_VS_PC_3,
   VAL_DELTA_PA_VS_PC_4,
   VAL_DELTA_PA_VS_PC_5,
   VAL_DELTA_AT_VS_PC1,
   VAL_DELTA_PC1_VS_PC2,
   VAL_DELTA_PC2_VS_PC3,
   VAL_DELTA_PC3_VS_PC4,
   VAL_DELTA_PC4_VS_PC5,
   VAL_DELTA_PC5_VS_PC6
)
AS
   SELECT D.COD_ABI_CARTOLARIZZATO,
          D.COD_ABI_ISTITUTO,
          D.DESC_ISTITUTO,
          D.COD_NDG,
          D.COD_SNDG,
          D.DTA_CONTROLLO_AT,
          D.VAL_STRATEGIA_CREDITIZIA_AT,
          D.VAL_PD_ONLINE_AT,
          D.VAL_PD_MONIT_AT,
          D.DTA_PD_MONIT_AT,
          D.VAL_IRIS_CLI_AT,
          D.VAL_LGD_AT,
          D.VAL_EAD_AT,
          D.SCSB_ACC_TOT_AT,
          D.SCSB_UTI_TOT_AT,
          D.SCGB_ACC_TOT_AT,
          D.SCGB_UTI_TOT_AT,
          D.SCSB_ACC_CASSA_BT_AT,
          D.SCSB_UTI_CASSA_BT_AT,
          D.SCGB_ACC_CASSA_BT_AT,
          D.SCGB_UTI_CASSA_BT_AT,
          D.SCSB_QIS_ACC_AT,
          D.SCSB_QIS_UTI_AT,
          D.SCGB_QIS_ACC_AT,
          D.SCGB_QIS_UTI_AT,
          D.SCSB_SCONFINO_AT,
          D.VAL_PA_AT,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_1),
                  1, NULL,
                  D.COD_STATO_1)
             COD_STATO_1,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_1),
                  1, TO_DATE (NULL),
                  D.DTA_CONTROLLO_1)
             DTA_CONTROLLO_1,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_1),
                  1, NULL,
                  D.VAL_STRATEGIA_CREDITIZIA_1)
             VAL_STRATEGIA_CREDITIZIA_1,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_1),
                  1, TO_NUMBER (NULL),
                  D.VAL_PD_ONLINE_1)
             VAL_PD_ONLINE_1,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_1),
                  1, TO_NUMBER (NULL),
                  D.VAL_PD_MONIT_1)
             VAL_PD_MONIT_1,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_1),
                  1, TO_DATE (NULL),
                  D.DTA_PD_MONIT_1)
             DTA_PD_MONIT_1,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_1),
                  1, NULL,
                  D.VAL_RATING_1)
             VAL_RATING_1,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_1),
                  1, TO_NUMBER (TO_NUMBER (NULL)),
                  D.VAL_IRIS_CLI_1)
             VAL_IRIS_CLI_1,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_1),
                  1, TO_NUMBER (NULL),
                  D.VAL_LGD_1)
             VAL_LGD_1,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_1),
                  1, TO_NUMBER (NULL),
                  D.VAL_EAD_1)
             VAL_EAD_1,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_1),
                  1, TO_NUMBER (NULL),
                  D.SCSB_ACC_TOT_1)
             SCSB_ACC_TOT_1,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_1),
                  1, TO_NUMBER (NULL),
                  D.SCSB_UTI_TOT_1)
             SCSB_UTI_TOT_1,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_1),
                  1, TO_NUMBER (NULL),
                  D.SCGB_ACC_TOT_1)
             SCGB_ACC_TOT_1,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_1),
                  1, TO_NUMBER (NULL),
                  D.SCGB_UTI_TOT_1)
             SCGB_UTI_TOT_1,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_1),
                  1, TO_NUMBER (NULL),
                  D.SCSB_ACC_CASSA_BT_1)
             SCSB_ACC_CASSA_BT_1,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_1),
                  1, TO_NUMBER (NULL),
                  D.SCSB_UTI_CASSA_BT_1)
             SCSB_UTI_CASSA_BT_1,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_1),
                  1, TO_NUMBER (NULL),
                  D.SCGB_ACC_CASSA_BT_1)
             SCGB_ACC_CASSA_BT_1,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_1),
                  1, TO_NUMBER (NULL),
                  D.SCGB_UTI_CASSA_BT_1)
             SCGB_UTI_CASSA_BT_1,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_1),
                  1, TO_NUMBER (NULL),
                  D.SCSB_QIS_ACC_1)
             SCSB_QIS_ACC_1,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_1),
                  1, TO_NUMBER (NULL),
                  D.SCSB_QIS_UTI_1)
             SCSB_QIS_UTI_1,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_1),
                  1, TO_NUMBER (NULL),
                  D.SCGB_QIS_ACC_1)
             SCGB_QIS_ACC_1,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_1),
                  1, TO_NUMBER (NULL),
                  D.SCGB_QIS_UTI_1)
             SCGB_QIS_UTI_1,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_1),
                  1, TO_NUMBER (NULL),
                  D.SCSB_SCONFINO_1)
             SCSB_SCONFINO_1,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_1),
                  1, TO_NUMBER (NULL),
                  D.VAL_PA_1)
             VAL_PA_1,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_2),
                  1, NULL,
                  D.COD_STATO_2)
             COD_STATO_2,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_2),
                  1, TO_DATE (NULL),
                  D.DTA_CONTROLLO_2)
             DTA_CONTROLLO_2,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_2),
                  1, NULL,
                  D.VAL_STRATEGIA_CREDITIZIA_2)
             VAL_STRATEGIA_CREDITIZIA_2,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_2),
                  1, TO_NUMBER (NULL),
                  D.VAL_PD_ONLINE_2)
             VAL_PD_ONLINE_2,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_2),
                  1, TO_NUMBER (NULL),
                  D.VAL_PD_MONIT_2)
             VAL_PD_MONIT_2,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_2),
                  1, TO_DATE (NULL),
                  D.DTA_PD_MONIT_2)
             DTA_PD_MONIT_2,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_2),
                  1, NULL,
                  D.VAL_RATING_2)
             VAL_RATING_2,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_2),
                  1, TO_NUMBER (NULL),
                  D.VAL_IRIS_CLI_2)
             VAL_IRIS_CLI_2,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_2),
                  1, TO_NUMBER (NULL),
                  D.VAL_LGD_2)
             VAL_LGD_2,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_2),
                  1, TO_NUMBER (NULL),
                  D.VAL_EAD_2)
             VAL_EAD_2,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_2),
                  1, TO_NUMBER (NULL),
                  D.SCSB_ACC_TOT_2)
             SCSB_ACC_TOT_2,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_2),
                  1, TO_NUMBER (NULL),
                  D.SCSB_UTI_TOT_2)
             SCSB_UTI_TOT_2,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_2),
                  1, TO_NUMBER (NULL),
                  D.SCGB_ACC_TOT_2)
             SCGB_ACC_TOT_2,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_2),
                  1, TO_NUMBER (NULL),
                  D.SCGB_UTI_TOT_2)
             SCGB_UTI_TOT_2,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_2),
                  1, TO_NUMBER (NULL),
                  D.SCSB_ACC_CASSA_BT_2)
             SCSB_ACC_CASSA_BT_2,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_2),
                  1, TO_NUMBER (NULL),
                  D.SCSB_UTI_CASSA_BT_2)
             SCSB_UTI_CASSA_BT_2,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_2),
                  1, TO_NUMBER (NULL),
                  D.SCGB_ACC_CASSA_BT_2)
             SCGB_ACC_CASSA_BT_2,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_2),
                  1, TO_NUMBER (NULL),
                  D.SCGB_UTI_CASSA_BT_2)
             SCGB_UTI_CASSA_BT_2,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_2),
                  1, TO_NUMBER (NULL),
                  D.SCSB_QIS_ACC_2)
             SCSB_QIS_ACC_2,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_2),
                  1, TO_NUMBER (NULL),
                  D.SCSB_QIS_UTI_2)
             SCSB_QIS_UTI_2,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_2),
                  1, TO_NUMBER (NULL),
                  D.SCGB_QIS_ACC_2)
             SCGB_QIS_ACC_2,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_2),
                  1, TO_NUMBER (NULL),
                  D.SCGB_QIS_UTI_2)
             SCGB_QIS_UTI_2,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_2),
                  1, TO_NUMBER (NULL),
                  D.SCSB_SCONFINO_2)
             SCSB_SCONFINO_2,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_2),
                  1, TO_NUMBER (NULL),
                  D.VAL_PA_2)
             VAL_PA_2,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_3),
                  1, NULL,
                  D.COD_STATO_3)
             COD_STATO_3,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_3),
                  1, TO_DATE (NULL),
                  D.DTA_CONTROLLO_3)
             DTA_CONTROLLO_3,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_3),
                  1, NULL,
                  D.VAL_STRATEGIA_CREDITIZIA_3)
             VAL_STRATEGIA_CREDITIZIA_3,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_3),
                  1, TO_NUMBER (NULL),
                  D.VAL_PD_ONLINE_3)
             VAL_PD_ONLINE_3,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_3),
                  1, TO_NUMBER (NULL),
                  D.VAL_PD_MONIT_3)
             VAL_PD_MONIT_3,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_3),
                  1, TO_DATE (NULL),
                  D.DTA_PD_MONIT_3)
             DTA_PD_MONIT_3,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_3),
                  1, NULL,
                  D.VAL_RATING_3)
             VAL_RATING_3,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_3),
                  1, TO_NUMBER (NULL),
                  D.VAL_IRIS_CLI_3)
             VAL_IRIS_CLI_3,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_3),
                  1, TO_NUMBER (NULL),
                  D.VAL_LGD_3)
             VAL_LGD_3,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_3),
                  1, TO_NUMBER (NULL),
                  D.VAL_EAD_3)
             VAL_EAD_3,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_3),
                  1, TO_NUMBER (NULL),
                  D.SCSB_ACC_TOT_3)
             SCSB_ACC_TOT_3,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_3),
                  1, TO_NUMBER (NULL),
                  D.SCSB_UTI_TOT_3)
             SCSB_UTI_TOT_3,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_3),
                  1, TO_NUMBER (NULL),
                  D.SCGB_ACC_TOT_3)
             SCGB_ACC_TOT_3,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_3),
                  1, TO_NUMBER (NULL),
                  D.SCGB_UTI_TOT_3)
             SCGB_UTI_TOT_3,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_3),
                  1, TO_NUMBER (NULL),
                  D.SCSB_ACC_CASSA_BT_3)
             SCSB_ACC_CASSA_BT_3,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_3),
                  1, TO_NUMBER (NULL),
                  D.SCSB_UTI_CASSA_BT_3)
             SCSB_UTI_CASSA_BT_3,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_3),
                  1, TO_NUMBER (NULL),
                  D.SCGB_ACC_CASSA_BT_3)
             SCGB_ACC_CASSA_BT_3,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_3),
                  1, TO_NUMBER (NULL),
                  D.SCGB_UTI_CASSA_BT_3)
             SCGB_UTI_CASSA_BT_3,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_3),
                  1, TO_NUMBER (NULL),
                  D.SCSB_QIS_ACC_3)
             SCSB_QIS_ACC_3,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_3),
                  1, TO_NUMBER (NULL),
                  D.SCSB_QIS_UTI_3)
             SCSB_QIS_UTI_3,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_3),
                  1, TO_NUMBER (NULL),
                  D.SCGB_QIS_ACC_3)
             SCGB_QIS_ACC_3,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_3),
                  1, TO_NUMBER (NULL),
                  D.SCGB_QIS_UTI_3)
             SCGB_QIS_UTI_3,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_3),
                  1, TO_NUMBER (NULL),
                  D.SCSB_SCONFINO_3)
             SCSB_SCONFINO_3,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_3),
                  1, TO_NUMBER (NULL),
                  D.VAL_PA_3)
             VAL_PA_3,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_4),
                  1, NULL,
                  D.COD_STATO_4)
             COD_STATO_4,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_4),
                  1, TO_DATE (NULL),
                  D.DTA_CONTROLLO_4)
             DTA_CONTROLLO_4,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_4),
                  1, NULL,
                  D.VAL_STRATEGIA_CREDITIZIA_4)
             VAL_STRATEGIA_CREDITIZIA_4,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_4),
                  1, TO_NUMBER (NULL),
                  D.VAL_PD_ONLINE_4)
             VAL_PD_ONLINE_4,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_4),
                  1, TO_NUMBER (NULL),
                  D.VAL_PD_MONIT_4)
             VAL_PD_MONIT_4,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_4),
                  1, TO_DATE (NULL),
                  D.DTA_PD_MONIT_4)
             DTA_PD_MONIT_4,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_4),
                  1, NULL,
                  D.VAL_RATING_4)
             VAL_RATING_4,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_4),
                  1, TO_NUMBER (NULL),
                  D.VAL_IRIS_CLI_4)
             VAL_IRIS_CLI_4,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_4),
                  1, TO_NUMBER (NULL),
                  D.VAL_LGD_4)
             VAL_LGD_4,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_4),
                  1, TO_NUMBER (NULL),
                  D.VAL_EAD_4)
             VAL_EAD_4,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_4),
                  1, TO_NUMBER (NULL),
                  D.SCSB_ACC_TOT_4)
             SCSB_ACC_TOT_4,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_4),
                  1, TO_NUMBER (NULL),
                  D.SCSB_UTI_TOT_4)
             SCSB_UTI_TOT_4,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_4),
                  1, TO_NUMBER (NULL),
                  D.SCGB_ACC_TOT_4)
             SCGB_ACC_TOT_4,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_4),
                  1, TO_NUMBER (NULL),
                  D.SCGB_UTI_TOT_4)
             SCGB_UTI_TOT_4,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_4),
                  1, TO_NUMBER (NULL),
                  D.SCSB_ACC_CASSA_BT_4)
             SCSB_ACC_CASSA_BT_4,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_4),
                  1, TO_NUMBER (NULL),
                  D.SCSB_UTI_CASSA_BT_4)
             SCSB_UTI_CASSA_BT_4,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_4),
                  1, TO_NUMBER (NULL),
                  D.SCGB_ACC_CASSA_BT_4)
             SCGB_ACC_CASSA_BT_4,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_4),
                  1, TO_NUMBER (NULL),
                  D.SCGB_UTI_CASSA_BT_4)
             SCGB_UTI_CASSA_BT_4,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_4),
                  1, TO_NUMBER (NULL),
                  D.SCSB_QIS_ACC_4)
             SCSB_QIS_ACC_4,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_4),
                  1, TO_NUMBER (NULL),
                  D.SCSB_QIS_UTI_4)
             SCSB_QIS_UTI_4,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_4),
                  1, TO_NUMBER (NULL),
                  D.SCGB_QIS_ACC_4)
             SCGB_QIS_ACC_4,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_4),
                  1, TO_NUMBER (NULL),
                  D.SCGB_QIS_UTI_4)
             SCGB_QIS_UTI_4,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_4),
                  1, TO_NUMBER (NULL),
                  D.SCSB_SCONFINO_4)
             SCSB_SCONFINO_4,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_4),
                  1, TO_NUMBER (NULL),
                  D.VAL_PA_4)
             VAL_PA_4,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_5),
                  1, NULL,
                  D.COD_STATO_5)
             COD_STATO_5,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_5),
                  1, TO_DATE (NULL),
                  D.DTA_CONTROLLO_5)
             DTA_CONTROLLO_5,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_5),
                  1, NULL,
                  D.VAL_STRATEGIA_CREDITIZIA_5)
             VAL_STRATEGIA_CREDITIZIA_5,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_5),
                  1, TO_NUMBER (NULL),
                  D.VAL_PD_ONLINE_5)
             VAL_PD_ONLINE_5,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_5),
                  1, TO_NUMBER (NULL),
                  D.VAL_PD_MONIT_5)
             VAL_PD_MONIT_5,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_5),
                  1, TO_DATE (NULL),
                  D.DTA_PD_MONIT_5)
             DTA_PD_MONIT_5,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_5),
                  1, NULL,
                  D.VAL_RATING_5)
             VAL_RATING_5,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_5),
                  1, TO_NUMBER (NULL),
                  D.VAL_IRIS_CLI_5)
             VAL_IRIS_CLI_5,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_5),
                  1, TO_NUMBER (NULL),
                  D.VAL_LGD_5)
             VAL_LGD_5,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_5),
                  1, TO_NUMBER (NULL),
                  D.VAL_EAD_5)
             VAL_EAD_5,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_5),
                  1, TO_NUMBER (NULL),
                  D.SCSB_ACC_TOT_5)
             SCSB_ACC_TOT_5,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_5),
                  1, TO_NUMBER (NULL),
                  D.SCSB_UTI_TOT_5)
             SCSB_UTI_TOT_5,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_5),
                  1, TO_NUMBER (NULL),
                  D.SCGB_ACC_TOT_5)
             SCGB_ACC_TOT_5,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_5),
                  1, TO_NUMBER (NULL),
                  D.SCGB_UTI_TOT_5)
             SCGB_UTI_TOT_5,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_5),
                  1, TO_NUMBER (NULL),
                  D.SCSB_ACC_CASSA_BT_5)
             SCSB_ACC_CASSA_BT_5,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_5),
                  1, TO_NUMBER (NULL),
                  D.SCSB_UTI_CASSA_BT_5)
             SCSB_UTI_CASSA_BT_5,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_5),
                  1, TO_NUMBER (NULL),
                  D.SCGB_ACC_CASSA_BT_5)
             SCGB_ACC_CASSA_BT_5,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_5),
                  1, TO_NUMBER (NULL),
                  D.SCGB_UTI_CASSA_BT_5)
             SCGB_UTI_CASSA_BT_5,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_5),
                  1, TO_NUMBER (NULL),
                  D.SCSB_QIS_ACC_5)
             SCSB_QIS_ACC_5,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_5),
                  1, TO_NUMBER (NULL),
                  D.SCSB_QIS_UTI_5)
             SCSB_QIS_UTI_5,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_5),
                  1, TO_NUMBER (NULL),
                  D.SCGB_QIS_ACC_5)
             SCGB_QIS_ACC_5,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_5),
                  1, TO_NUMBER (NULL),
                  D.SCGB_QIS_UTI_5)
             SCGB_QIS_UTI_5,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_5),
                  1, TO_NUMBER (NULL),
                  D.SCSB_SCONFINO_5)
             SCSB_SCONFINO_5,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_5),
                  1, TO_NUMBER (NULL),
                  D.VAL_PA_5)
             VAL_PA_5,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_6),
                  1, NULL,
                  D.COD_STATO_6)
             COD_STATO_6,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_6),
                  1, TO_DATE (NULL),
                  D.DTA_CONTROLLO_6)
             DTA_CONTROLLO_6,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_6),
                  1, NULL,
                  D.VAL_STRATEGIA_CREDITIZIA_6)
             VAL_STRATEGIA_CREDITIZIA_6,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_6),
                  1, TO_NUMBER (NULL),
                  D.VAL_PD_ONLINE_6)
             VAL_PD_ONLINE_6,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_6),
                  1, TO_NUMBER (NULL),
                  D.VAL_PD_MONIT_6)
             VAL_PD_MONIT_6,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_6),
                  1, TO_DATE (NULL),
                  D.DTA_PD_MONIT_6)
             DTA_PD_MONIT_6,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_6),
                  1, NULL,
                  D.VAL_RATING_6)
             VAL_RATING_6,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_6),
                  1, TO_NUMBER (NULL),
                  D.VAL_IRIS_CLI_6)
             VAL_IRIS_CLI_6,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_6),
                  1, TO_NUMBER (NULL),
                  D.VAL_LGD_6)
             VAL_LGD_6,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_6),
                  1, TO_NUMBER (NULL),
                  D.VAL_EAD_6)
             VAL_EAD_6,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_6),
                  1, TO_NUMBER (NULL),
                  D.SCSB_ACC_TOT_6)
             SCSB_ACC_TOT_6,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_6),
                  1, TO_NUMBER (NULL),
                  D.SCSB_UTI_TOT_6)
             SCSB_UTI_TOT_6,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_6),
                  1, TO_NUMBER (NULL),
                  D.SCGB_ACC_TOT_6)
             SCGB_ACC_TOT_6,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_6),
                  1, TO_NUMBER (NULL),
                  D.SCGB_UTI_TOT_6)
             SCGB_UTI_TOT_6,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_6),
                  1, TO_NUMBER (NULL),
                  D.SCSB_ACC_CASSA_BT_6)
             SCSB_ACC_CASSA_BT_6,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_6),
                  1, TO_NUMBER (NULL),
                  D.SCSB_UTI_CASSA_BT_6)
             SCSB_UTI_CASSA_BT_6,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_6),
                  1, TO_NUMBER (NULL),
                  D.SCGB_ACC_CASSA_BT_6)
             SCGB_ACC_CASSA_BT_6,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_6),
                  1, TO_NUMBER (NULL),
                  D.SCGB_UTI_CASSA_BT_6)
             SCGB_UTI_CASSA_BT_6,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_6),
                  1, TO_NUMBER (NULL),
                  D.SCSB_QIS_ACC_6)
             SCSB_QIS_ACC_6,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_6),
                  1, TO_NUMBER (NULL),
                  D.SCSB_QIS_UTI_6)
             SCSB_QIS_UTI_6,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_6),
                  1, TO_NUMBER (NULL),
                  D.SCGB_QIS_ACC_6)
             SCGB_QIS_ACC_6,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_6),
                  1, TO_NUMBER (NULL),
                  D.SCGB_QIS_UTI_6)
             SCGB_QIS_UTI_6,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_6),
                  1, TO_NUMBER (NULL),
                  D.SCSB_SCONFINO_6)
             SCSB_SCONFINO_6,
          DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_6),
                  1, TO_NUMBER (NULL),
                  D.VAL_PA_6)
             VAL_PA_6,
          X.COD_STATO COD_STATO_AT,
          F.DTA_FINE_VALIDITA_RC DTA_CONTROLLO_PC,
          F.COD_STATO COD_STATO_PC,
          F.COD_STRATEGIA_CRZ VAL_STRATEGIA_CREDITIZIA_PC,
          F.VAL_PD_ONLINE VAL_PD_ONLINE_PC,
          F.VAL_PD VAL_PD_MONIT_PC,
          F.DTA_PD DTA_PD_MONIT_PC,
          F.VAL_RATING VAL_RATING_PC,
          F.VAL_IRIS_CLI VAL_IRIS_CLI_PC,
          F.VAL_LGD VAL_LGD_PC,
          F.VAL_EAD VAL_EAD_PC,
          F.SCSB_ACC_CASSA + F.SCSB_ACC_FIRMA SCSB_ACC_TOT_PC,
          F.SCSB_UTI_CASSA + F.SCSB_UTI_FIRMA SCSB_UTI_TOT_PC,
          F.SCGB_ACC_CASSA + F.SCGB_ACC_FIRMA SCGB_ACC_TOT_PC,
          F.SCGB_UTI_CASSA + F.SCGB_UTI_FIRMA SCGB_UTI_TOT_PC,
          F.SCSB_ACC_CASSA_BT SCSB_ACC_CASSA_BT_PC,
          F.SCSB_UTI_CASSA_BT SCSB_UTI_CASSA_BT_PC,
          F.SCGB_ACC_CASSA_BT SCGB_ACC_CASSA_BT_PC,
          F.SCGB_UTI_CASSA_BT SCGB_UTI_CASSA_BT_PC,
          TO_NUMBER (NULLIF (F.SCSB_QIS_ACC, 'N.D.')) SCSB_QIS_ACC_PC,
          TO_NUMBER (NULLIF (F.SCSB_QIS_UTI, 'N.D.')) SCSB_QIS_UTI_PC,
          TO_NUMBER (NULLIF (F.SCGB_QIS_ACC, 'N.D.')) SCGB_QIS_ACC_PC,
          TO_NUMBER (NULLIF (F.SCGB_QIS_UTI, 'N.D.')) SCGB_QIS_UTI_PC,
          F.VAL_SCONFINO SCSB_SCONFINO_PC,
          F.VAL_PA VAL_PA_PC,
          DECODE (
             VAL_PA_AT,
             0, 'ND',
             TO_CHAR (ROUND ( (F.VAL_PA / VAL_PA_AT) * 100, 2),
                      99999999990.99))
             VAL_PA_VS_PC_AT,
          DECODE (
             DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_1),
                     1, TO_NUMBER (NULL),
                     D.VAL_PA_1),
             0, 'ND',
             TO_CHAR (
                ROUND (
                     (  F.VAL_PA
                      / DECODE (
                           SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_1),
                           1, TO_NUMBER (NULL),
                           D.VAL_PA_1))
                   * 100,
                   2),
                99999999990.99))
             VAL_PA_VS_PC_1,
          DECODE (
             DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_2),
                     1, TO_NUMBER (NULL),
                     D.VAL_PA_2),
             0, 'ND',
             TO_CHAR (
                ROUND (
                     (  F.VAL_PA
                      / DECODE (
                           SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_2),
                           1, TO_NUMBER (NULL),
                           D.VAL_PA_2))
                   * 100,
                   2),
                99999999990.99))
             VAL_PA_VS_PC_2,
          DECODE (
             DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_3),
                     1, TO_NUMBER (NULL),
                     D.VAL_PA_3),
             0, 'ND',
             TO_CHAR (
                ROUND (
                     (  F.VAL_PA
                      / DECODE (
                           SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_3),
                           1, TO_NUMBER (NULL),
                           D.VAL_PA_3))
                   * 100,
                   2),
                99999999990.99))
             VAL_PA_VS_PC_3,
          DECODE (
             DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_4),
                     1, TO_NUMBER (NULL),
                     D.VAL_PA_4),
             0, 'ND',
             TO_CHAR (
                ROUND (
                     (  F.VAL_PA
                      / DECODE (
                           SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_4),
                           1, TO_NUMBER (NULL),
                           D.VAL_PA_4))
                   * 100,
                   2),
                99999999990.99))
             VAL_PA_VS_PC_4,
          DECODE (
             DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_5),
                     1, TO_NUMBER (NULL),
                     D.VAL_PA_5),
             0, 'ND',
             TO_CHAR (
                ROUND (
                     (  F.VAL_PA
                      / DECODE (
                           SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_5),
                           1, TO_NUMBER (NULL),
                           D.VAL_PA_5))
                   * 100,
                   2),
                99999999990.99))
             VAL_PA_VS_PC_5,
          DECODE (
             VAL_PA_AT,
             0, 'ND',
             TO_CHAR (ROUND ( (100 - ( (F.VAL_PA / VAL_PA_AT)) * 100), 2),
                      99999999990.99))
             VAL_DELTA_PA_VS_PC_AT,
          DECODE (
             DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_1),
                     1, TO_NUMBER (NULL),
                     D.VAL_PA_1),
             0, 'ND',
             TO_CHAR (
                ROUND (
                   (  100
                    -   ( (  F.VAL_PA
                           / DECODE (
                                SIGN (
                                   F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_1),
                                1, TO_NUMBER (NULL),
                                D.VAL_PA_1)))
                      * 100),
                   2),
                99999999990.99))
             VAL_DELTA_PA_VS_PC_1,
          DECODE (
             DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_2),
                     1, TO_NUMBER (NULL),
                     D.VAL_PA_2),
             0, 'ND',
             TO_CHAR (
                ROUND (
                   (  100
                    -   ( (  F.VAL_PA
                           / DECODE (
                                SIGN (
                                   F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_2),
                                1, TO_NUMBER (NULL),
                                D.VAL_PA_2)))
                      * 100),
                   2),
                99999999990.99))
             VAL_DELTA_PA_VS_PC_2,
          DECODE (
             DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_3),
                     1, TO_NUMBER (NULL),
                     D.VAL_PA_3),
             0, 'ND',
             TO_CHAR (
                ROUND (
                   (  100
                    -   ( (  F.VAL_PA
                           / DECODE (
                                SIGN (
                                   F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_3),
                                1, TO_NUMBER (NULL),
                                D.VAL_PA_3)))
                      * 100),
                   2),
                99999999990.99))
             VAL_DELTA_PA_VS_PC_3,
          DECODE (
             DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_4),
                     1, TO_NUMBER (NULL),
                     D.VAL_PA_4),
             0, 'ND',
             TO_CHAR (
                ROUND (
                   (  100
                    -   ( (  F.VAL_PA
                           / DECODE (
                                SIGN (
                                   F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_4),
                                1, TO_NUMBER (NULL),
                                D.VAL_PA_4)))
                      * 100),
                   2),
                99999999990.99))
             VAL_DELTA_PA_VS_PC_4,
          DECODE (
             DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_5),
                     1, TO_NUMBER (NULL),
                     D.VAL_PA_5),
             0, 'ND',
             TO_CHAR (
                ROUND (
                   (  100
                    -   ( (  F.VAL_PA
                           / DECODE (
                                SIGN (
                                   F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_5),
                                1, TO_NUMBER (NULL),
                                D.VAL_PA_5)))
                      * 100),
                   2),
                99999999990.99))
             VAL_DELTA_PA_VS_PC_5,
          DECODE (
             DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_1),
                     1, TO_NUMBER (NULL),
                     D.VAL_PA_1),
             0, 'ND',
             TO_CHAR (
                ROUND (
                   (  100
                    -   ( (  VAL_PA_AT
                           / DECODE (
                                SIGN (
                                   F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_1),
                                1, TO_NUMBER (NULL),
                                D.VAL_PA_1)))
                      * 100),
                   2),
                99999999990.99))
             VAL_DELTA_AT_VS_PC1,
          DECODE (
             DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_2),
                     1, TO_NUMBER (NULL),
                     D.VAL_PA_2),
             0, 'ND',
             TO_CHAR (
                ROUND (
                   (  100
                    -   ( (  DECODE (
                                SIGN (
                                   F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_1),
                                1, TO_NUMBER (NULL),
                                D.VAL_PA_1)
                           / DECODE (
                                SIGN (
                                   F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_2),
                                1, TO_NUMBER (NULL),
                                D.VAL_PA_2)))
                      * 100),
                   2),
                99999999990.99))
             VAL_DELTA_PC1_VS_PC2,
          DECODE (
             DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_3),
                     1, TO_NUMBER (NULL),
                     D.VAL_PA_3),
             0, 'ND',
             TO_CHAR (
                ROUND (
                   (  100
                    -   ( (  DECODE (
                                SIGN (
                                   F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_2),
                                1, TO_NUMBER (NULL),
                                D.VAL_PA_2)
                           / DECODE (
                                SIGN (
                                   F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_3),
                                1, TO_NUMBER (NULL),
                                D.VAL_PA_3)))
                      * 100),
                   2),
                99999999990.99))
             VAL_DELTA_PC2_VS_PC3,
          DECODE (
             DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_4),
                     1, TO_NUMBER (NULL),
                     D.VAL_PA_4),
             0, 'ND',
             TO_CHAR (
                ROUND (
                   (  100
                    -   ( (  DECODE (
                                SIGN (
                                   F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_3),
                                1, TO_NUMBER (NULL),
                                D.VAL_PA_3)
                           / DECODE (
                                SIGN (
                                   F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_4),
                                1, TO_NUMBER (NULL),
                                D.VAL_PA_4)))
                      * 100),
                   2),
                99999999990.99))
             VAL_DELTA_PC3_VS_PC4,
          DECODE (
             DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_5),
                     1, TO_NUMBER (NULL),
                     D.VAL_PA_5),
             0, 'ND',
             TO_CHAR (
                ROUND (
                   (  100
                    -   ( (  DECODE (
                                SIGN (
                                   F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_4),
                                1, TO_NUMBER (NULL),
                                D.VAL_PA_4)
                           / DECODE (
                                SIGN (
                                   F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_5),
                                1, TO_NUMBER (NULL),
                                D.VAL_PA_5)))
                      * 100),
                   2),
                99999999990.99))
             VAL_DELTA_PC4_VS_PC5,
          DECODE (
             DECODE (SIGN (F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_6),
                     1, TO_NUMBER (NULL),
                     D.VAL_PA_6),
             0, 'ND',
             TO_CHAR (
                ROUND (
                   (  100
                    -   ( (  DECODE (
                                SIGN (
                                   F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_5),
                                1, TO_NUMBER (NULL),
                                D.VAL_PA_5)
                           / DECODE (
                                SIGN (
                                   F.DTA_FINE_VALIDITA - D.DTA_CONTROLLO_6),
                                1, TO_NUMBER (NULL),
                                D.VAL_PA_6)))
                      * 100),
                   2),
                99999999990.99))
             VAL_DELTA_PC5_VS_PC6
     FROM MV_MCRE0_APP_RIO_MONITORAGGIO D,
          VTMCRE0_APP_UPD_FIELDS_P1 X,
          (SELECT *
             FROM (SELECT E1.*,
                          MAX (
                             E1.DTA_FINE_VALIDITA)
                          OVER (
                             PARTITION BY E1.COD_ABI_CARTOLARIZZATO,
                                          E1.COD_NDG)
                             DTA_FINE_VALIDITA_RC
                     FROM T_MCRE0_APP_STORICO_EVENTI E1
                    WHERE E1.FLG_CAMBIO_GESTORE = '1') E2
            WHERE DTA_FINE_VALIDITA_RC = DTA_FINE_VALIDITA) F
    WHERE     D.COD_ABI_CARTOLARIZZATO = X.COD_ABI_CARTOLARIZZATO(+)
          AND D.COD_NDG = X.COD_NDG(+)
          AND D.COD_ABI_CARTOLARIZZATO = F.COD_ABI_CARTOLARIZZATO(+)
          AND D.COD_NDG = F.COD_NDG(+);


GRANT DELETE, INSERT, REFERENCES, SELECT, UPDATE, ON COMMIT REFRESH, QUERY REWRITE, DEBUG, FLASHBACK ON MCRE_OWN.VTMCRE0_APP_RIO_MONITORAGGIO TO MCRE_USR;
